<project name="JavaCup" default="install">
  <property name="czt.home" location="../../"/>
  <property file="${czt.home}/czt.properties"/>
  <property name="czt.lib" location="${czt.home}/${jar.dir}"/>
  <property name="jar.file" location="${czt.lib}/${java_cup.jar.file}"/>
  <property name="src.dir" location="src"/>
  <property name="build.dir" location="build"/>
  <property name="package.dir" location="src/net/sourceforge/czt/java_cup/"/>

  <path id="classpath">
    <pathelement path="${javacup.home}"/>
    <pathelement path="${java.class.path}"/>
  </path>

  <target name="init">
    <tstamp/>
    <mkdir dir="${build.dir}"/>
  </target>

  <target name="-set-javacup-task">
    <taskdef classname="ant.JavaCupTask" name="java_cup"
      classpath="${czt.lib}/${java_cup.task.jar.file}"/>
  </target>

  <target name="install" depends="compile"
    description="Builds and installs the jar file in '../lib'.">
    <mkdir dir="${czt.lib}"/>
    <jar jarfile="${jar.file}">
      <fileset dir="${build.dir}"/>
    </jar>
  </target>

  <target name="compile" depends="init"
    description="Compiles the sources.">
    <javac source="1.5" srcdir="${src.dir}"
           destdir="${build.dir}"
           debug="${debug}" debuglevel="${debuglevel}" optimize="${optimize}">
      <classpath refid="classpath"/>
    </javac>
  </target>

  <target name="generate-src"
    depends="-set-javacup-task, compile_aux"
    description="Generate the sources of java_cup.">
    <java_cup
      destDir="${package.dir}"
      inputFile="${package.dir}/parser.cup"
      parserFile="parser"
      symbolFile="sym"
      classpath="${javacup.home}">
    </java_cup>
    <echo message="tunninsdsd"/>
  </target>

  <target name="compile_aux" depends="init"
          description="Compiles the sources.">
    <javac source="1.5" srcdir="${src.dir}"
           destdir="${build.dir}"
           debug="${debug}" debuglevel="${debuglevel}" optimize="${optimize}">
      <classpath refid="classpath"/>
    </javac>
  </target>

  <target name="printclasspath">
      <pathconvert targetos="unix" property="tmp.clspath"
            refid="classpath">
    </pathconvert>
    <echo message="CLASSPATH = ${tmp.clspath}"/>
  </target>

  <target name="clean" description="Cleans up.">
    <delete dir="${build.dir}"/>
  </target>
</project>
