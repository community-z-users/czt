<project name="corejava" default="all" basedir=".">
  <property file="czt.properties"/>

  <target name="all" depends="install"/>

  <target name="install"
    depends="install-bin, install-subprojects"
    description="install"/>

  <target name="install-subprojects"
    depends="install-corejava, install-parser, install-gaffe, install-z2b"
    description="install subprojects">
  </target>

  <target name="install-ant-tasks" description="install ant tasks">
    <ant dir="devtools/ant" target="install"/>
  </target>

  <target name="install-corejava" description="install corejava">
    <ant dir="corejava" target="install"/>
  </target>

  <target name="install-parser" depends="install-ant-tasks, install-corejava"
    description="install parser">
    <ant dir="parser" target="install"/>
  </target>

  <target name="install-gaffe" depends="install-corejava"
    description="install gaffe">
    <ant dir="gaffe" target="install"/>
  </target>

  <target name="install-gaffe-generator" depends="install-gaffe"
    description="install gaffe generator">
    <ant dir="gaffe/generator" target="install"/>
  </target>

  <target name="install-z2b"
    depends="install-corejava, install-gaffe-generator"
    description="install z2b">
    <ant dir="translators/z2b" target="install"/>
  </target>

  <target name="install-bin" description="create settings file so that shell scripts work properly">
    <property name="settings.file" location="bin/settings.sh"/>
    <property name="czt.jar.dir" location="${basedir}/${jar.dir}"/>
    <echo file="${settings.file}" append="false">
# corejava jar files
COREJAVA=${czt.jar.dir}/${corejava.base.jar.file}:${czt.jar.dir}/${corejava.core.jar.file}:${czt.jar.dir}/${corejava.oz.jar.file}:${czt.jar.dir}/${corejava.zpatt.jar.file}:${czt.jar.dir}/${corejava.jaxb.jar.file}
# corejava base
COREJAVA_BASE=${czt.jar.dir}/${corejava.base.jar.file}
# Gaffe GUI generator and animator
GAFFE=${czt.jar.dir}/${gaffe.jar.file}:${czt.jar.dir}/${gaffe.generator.jar.file}
# java cup
JAVA_CUP=${javacup.home}
# JFlex
JFLEX=${jflex.jar}
# all jwsdp jar files needed for running corejava
JWSDP=${jwsdp.classpath}
# parser jar file
PARSER=${czt.jar.dir}/${parser.jar.file}
# rhino jar file
RHINO=${rhino.jar}
# Z2B translator jar file
Z2B=${czt.jar.dir}/${z2b.jar.file}
    </echo>
  </target>

  <target name="test" description="test subprojects">
    <ant dir="corejava" target="test"/>
    <ant dir="parser" target="test"/>
  </target>

  <target name="checkstyle" description="check java sources">
    <ant dir="corejava" target="checkstyle"/>
    <ant dir="parser" target="checkstyle"/>
  </target>

  <target name="clean" description="clean up subprojects">
    <delete dir="${jar.dir}"/>
    <ant dir="corejava" target="clean"/>
    <ant dir="devtools/ant" target="clean"/>
    <ant dir="gaffe" target="clean"/>
    <ant dir="gaffe/generator" target="clean"/>
    <ant dir="parser" target="clean"/>
    <ant dir="translators/z2b" target="clean"/>
  </target>
</project>
