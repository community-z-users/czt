<project name="czt" default="all" basedir="../">
  <property name="czt.home" location="../"/>
  <property file="czt.properties"/>
  <property name="unix.settings.file" location="bin/settings.sh"/>
  <property name="windows.settings.file" location="bin/settings.bat"/>

<!--
  <taskdef name="retroweaver"
    classname="com.rc.retroweaver.ant.RetroWeaverTask">
    <classpath>
      <fileset dir="/home/timothym/retroweaver/lib" includes="**/*"/>
      <pathelement
      location="${czt.home}/lib/retroweaver.jar"/>
    </classpath>
  </taskdef>
-->
  <target name="all" depends="czt_typecheck.jar"/>

  <target name="czt_typecheck.jar"
    description="build the czt typechecker jar file">
    <property name="czt.build.dir" location="build"/>
    <mkdir dir="${czt.build.dir}"/>
    <unjar src="${jar.dir}/${util.jar.file}" dest="${czt.build.dir}"/>
    <unjar src="${jar.dir}/${corejava.core.jar.file}" dest="${czt.build.dir}"/>
    <unjar src="${jar.dir}/${corejava.oz.jar.file}" dest="${czt.build.dir}"/>
    <unjar src="${jar.dir}/${session.jar.file}" dest="${czt.build.dir}"/>
    <unjar src="${jar.dir}/${java_cup.jar.file}" dest="${czt.build.dir}"/>
    <unjar src="${jar.dir}/${parser.jar.file}" dest="${czt.build.dir}"/>
    <unjar src="${jar.dir}/${typechecker.jar.file}" dest="${czt.build.dir}"/>
    <copy todir="${czt.build.dir}/czt">
      <fileset dir="bin/bsh"/>
    </copy>
<!--    <retroweaver srcdir="${czt.build.dir}"/>-->
    <jar jarfile="${jar.dir}/czt_typecheck.jar" update="true">
      <fileset dir="${czt.build.dir}"/>
      <manifest> 
        <attribute
          name="Main-Class"
          value="net.sourceforge.czt.typecheck.oz.TypeCheckUtils"/>
      </manifest>
    </jar>
    <delete dir="${czt.build.dir}"/>
   </target>
</project>
