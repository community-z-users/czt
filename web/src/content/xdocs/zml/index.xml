<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE document PUBLIC "-//APACHE//DTD Documentation V1.2//EN" "http://apache.org/forrest/dtd/document-v12.dtd">
<document> 
  <header> 
    <title>ZML: An XML markup for the Z specification language</title> 
  </header> 
  <body>
    <p>
      This page describes a XML markup for the Z, based on the
      ISO Z Standard (2002).  See Ian Toyn's 
      <link
      href="http://www-users.cs.york.ac.uk/~ian/cadiz/standard.html">list
      of differences</link>
      between standard Z and Spivey Z for an overview of most of the
      changes.  The official ISO Z standard (ISO/IEC 13568:2002) is now
      available for <link href="ext:iso-z-std">free download</link> (click
      on the 'Freely Available Standards' link in the left column, then
      search for 'Formal Specification'.  
    </p>
    <section>
      <title>Introduction</title>
    <p>
      The ZML format is specified by an XML schema file (Z.xsd).  This
      specifies the allowable 'syntax' of each ZML construct.
      See the
      <link href="http://www.tucs.fi/zb2003">ZB2003</link>
      proceedings for a paper describing this markup.  Example ZML
      files can be seen in the <link
      href="ext:zmlexamples"><code>zml/examples/z</code></link> directory
      of the CVS repository.
    </p>
    <p>
      To allow for evolution of the ZML format, each Z specification 
      file (spec.xml) should specify which version of the ZML format it is
      using, by including a
      <code>version="Major.Minor"</code>
      attribute in the
      <code>&lt;Spec&gt;</code>
      tag.  The default is the oldest version:
      <code>version="1.0"</code>.
    </p>
    </section>
    <section>
      <title>Versions of the ZML Schema</title>
    <p>
      The following table shows the public versions of Z.xsd that have been 
      released plus the official location of that schema (this can be
      used in the
      <code>schemalocation</code>
      attribute of .xml files).  It also relates that
      public version number to the internal revision number of Z.xsd 
      within the CZT CVS repository, and gives a summary of the significant
      changes from the previous version.  An exhaustive list of all changes
      to Z.xsd (most of which do not affect the XML format) can be found in
      the CZT
      <link href="http://sourceforge.net/cvs/?group_id=86250">CVS
      repository</link>. 
    </p>
    <table>
      <tr>
        <th>Version</th>
        <th>Location</th>
        <th>SVN/CVS Rev#</th>
        <th>Changes/Comments</th>
      </tr>
      <tr>
        <td>2.1</td>
        <td><link href="Z_2_1.xsd">Z_2_1.xsd</link></td>
        <td>5093</td>
        <td>
          Removed XML Schema elements and types DeclName, ZDeclName, RefName,
          and ZRefName and introduce new XML Schema elements and types Name and
          ZName instead since the distinction between DeclName and RefName does
          not seem to be relevant and makes handling of IDs more difficult.
          Name and ZName or now used in places where either a DeclName or a RefName
          has been used.
        </td>
      </tr>
      <tr>
        <td>2.0</td>
        <td><link href="Z_2_0.xsd">Z_2_0.xsd</link></td>
        <td>1.95</td>
        <td>
          Renamed the SchText element and type to ZSchText and added new
          abstract element and type SchText.  The element ZSchText is
          declared to be in the substitution group of (the new abstract)
          element SchText.  This makes it possible to define new kinds of
          schema texts by providing new elements that are in the
          substitution group of SchText like, for example, jokers
          (metavariables) as used in Cadiz's tactic language.
          <br/>
          Renamed the DeclName element and type to ZDeclName and added new
          abstract element and type DeclName.  The element ZDeclName is
          declared to be in the substitution group of (the new abstract)
          element DeclName.
          <br/>
          Renamed the RefName element and type to ZRefName and added new
          abstract element and type RefName.  The element ZRefName is
          declared to be in the substitution group of (the new abstract)
          element RefName.
          <br/>
          Deleted abstract element and type Name since it is no longer used.
          <br/>
          Added new element and type Numeral (abstract) and ZNumeral
          and use it in NumExpr and TupleSelExpr.
          <br/>
          Added new elements and types for lists: BranchList (abstract)
          and ZBranchList, DeclList (abstract)
          and ZDeclList, DeclNameList (abstract) and ZDeclNameList,
          ExprList (abstract) and ZExprList,
          FreetypeList (abstract) and ZFreetypeList, ParaList (abstract)
          and ZParaList, RefNameList (abstract) and ZRefNameList, RenameList
          (abstract) and ZRenameList, StrokeList (abstract) and ZStrokeList.
          Those are now used instead of sequences defined via minOccurs and
          maxOccurs elements.
          <br/>
          Removed element and type NameExprPair since it is not used any more.
          <br/>
          Removed element and type TypeEnvAnn since it is not used.  Use
          Signature instead.
          <br/>
          Rename NameNamePair as NewOldPair and use Z ordering of the names.
          <br/>
          Rename Number as Digit to distinguish it from Numeral.
          <br/>
          Rename type TermA as Term and let all other types extend
          from Term.  Now all elements can have annotations.
          <br/>
          Added new attribute Explicit to RefExpr.  It is used to
          distinguish whether the instantiating expressions are
          explicitly given in the specification (explicit is true) or
          whether they were inferred by the typechecker (explicit is
          false).
          <br/>
          Added new element/type Ann, an abstract base class for all
          annotations.  This is mostly for consistency with our other
          complex type hierarchies.
          <br/>
          Added new attributes Start and Length to LocAnn.
          <br/>
          Improve some documentation.
        </td>
      </tr>
      <tr>
        <td>1.4</td>
        <td><link href="Z_1_4.xsd">Z_1_4.xsd</link></td>
        <td>1.71</td>
        <td>
          Added new elements/types for SignatureAnn to be used by the
          typechecker.
        </td>
      </tr>
      <tr>
        <td>1.3</td>
        <td><link href="Z_1_3.xsd">Z_1_3.xsd</link></td>
        <td>1.69</td>
        <td>
          Added new elements/types LatexMarkupPara and Directive to support
          storing the latex markup function in the AST.
          <br/>
          Added new elements/types GenericType and Type2 to reflect
          the grammar for types given in the ISO Standard for Z.
          <br/>
          Renamed GenType to GenParamType to avoid confusion with
          GenericType.
          <br/>
          Changed attribute Loc in LocAnn to be optional.
          <br/>
          Changed attribute Prec in OptempPara to be optional.
          This can be used by, for instance, prefix templates, which do not
          have a precedence value.
          <br/>
          Remove the default value for the Assoc attribute.
          Not setting this attribute can be used by,
          for instance, prefix templates, which do not have an associativity.
          <br/>
          Changed element Oper to be abstract.
          <br/>
          Improved documentation.
        </td>
      </tr>
      <tr>
        <td>1.2</td>
        <td><link href="Z_1_2.xsd">Z_1_2.xsd</link></td>
        <td>1.55</td>
        <td>
          Changed operator templates to use an inheritance hierarchy for
          Operator and Operand.  This is more consistent with other parts
          of the schema, and allows stronger typing within the Java AST.
          This has changed the XML format slightly from:
          <source>&lt;OptempPara ...&gt;
  &lt;Operand/&gt;
  &lt;Word&gt;*&lt;/Word&gt;
  &lt;Operand/&gt;
&lt;/OptempPara&gt;</source>
          to
          <source>&lt;OptempPara ...&gt;
  &lt;Operand/&gt;
  &lt;Operator&gt;&lt;Word&gt;*&lt;/Word&gt;&lt;/Operator&gt;
  &lt;Operand/&gt;
&lt;/OptempPara&gt;</source>
        </td>
      </tr>
      <tr>
        <td>1.1</td>
        <td><link href="Z_1_1.xsd">Z_1_1.xsd</link></td>
        <td>1.39</td>
        <td>Changed namespace and schemaLocation to czt.sourceforge.net
        <br/>
        Added version/author/date/source-location attributes to &lt;Spec&gt;
        <br/>
        Changed operator templates slightly, so that they now contain a 
        (alternating) sequence of &lt;Word&gt; and &lt;Operand&gt; tags,
        where &lt;Operand&gt; may add the attribute <code>List="true"</code>
        to indicate an sequence of operands.
        <br/>
        Renamed FreeType to Freetype to conform to the Z standard.
        <br/>
        Added a tag around rename pairs, for consistency with other pairs and
        triples.  Also swapped the order of NewName and OldName within these
        pairs, to reflect the functional nature (domain -&gt; range) of the
        renaming.
        <br/>
        Removed ##other from Section and Paragraph because it causes ambiguity
        when extending the schema.  This makes the schema more strict, because
        standard XML validators will now REQUIRE Z extensions to have a schema.
        </td>
      </tr>
      <tr>
        <td>1.0</td>
        <td><link href="Z_1_0.xsd">Z_1_0.xsd</link></td>
        <td>1.16</td>
        <td>This version was described in the ZB2003 paper and used by
        several projects at the National University of Singapore.
        <br/>
        If &lt;Spec&gt; has no version attribute, this version is used.
        </td>
      </tr>
    </table>
    <p/>
    </section>
    <section>
      <title>Background and Rationale</title>
    <p>
      The goal of providing an XML markup for Z specifications is to
      make it easier for tools to exchange <em>annotated specifications</em>.
      For example, a specification might be parsed and typechecked by
      one tool, then passed to another tool (in XML format) which expands
      schema calculus and puts predicates into disjunctive normal form,
      then passed to another tool (in XML format) which generates test
      cases from each disjunct.  The XML format is simply a textual
      representation of the annotated syntax tree of the Z specification.
    </p>
    <p>
      Some advantages of using XML to exchange Z specifications between tools:
    </p>
    <ul>
      <li> all programming languages provide libraries for loading and saving
      XML files, so multiple-language toolsets are easier.</li>
      <li> annotations can be attached to any node of this ZML format,
      so it is easy to include type information for every variable
      and every expression.</li>
      <li> each tool does not need to parse and typecheck Z -- this can
      be done by one tool, and the results used by many other tools.</li>
      <li> there are many analysis and transformation tools for XML,
      such as the XSLT language which makes it easy to transform
      XML files into other formats.</li>
    </ul>
    <p>
      A disadvantage is that XML files are large (at least 20 times larger than
      the Z specification source), which makes transfer between tools a
      reasonably costly operation.  For this reason, CZT also offers libraries
      of Java classes and utilities which can directly manipulate the Z AST
      in memory.  This allows tighter integration of tools, but is limited
      to tools written in Java that use our Z AST classes.  So in practice,
      we expect that existing tools and non-Java tools will use the ZML format
      to transfer specifications between tools, while new Z tools written in 
      Java using CZT will be able to directly pass AST objects from one tool
      to another, as well as being able to read and write them as ZML.
    </p>
    </section>
  </body>
</document>
