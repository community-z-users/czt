%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% PREAMBLE: Circus toolkit, v 1.2 
%           Copyright 2004-2006 Leo Freitas
%           Department of Computer Science 
%           University of York, YO10 5DD UK
%           leo@cs.york.ac.uk, +44-1904-434753
%           http://www.cs.york.ac.uk/circus
%           http://www.cs.york.ac.uk/~leo
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{zsection}
  \SECTION circus\_toolkit \parents standard\_toolkit
\end{zsection}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Mark-up directives for core language symbols are as follows:
% The choice for pre, in, or post, has to do with how one wants
% the character to be rendered. See Z Std A.2.3.2.
%
% By using keychars, such as \circguard instead of &, we allow
% appropriate rendering by both LaTeX and Unicode mark-ups.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% TODO: Normalise the keywords and keychar latex names.
% TODO: Use just \circthen for both guarded commands and prefixing?
% TODO: Replicated Internal Choice Unicode 2294 is Wrong! FIX IT!
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Unicode symbols (divided like the sections of zchar.xml)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% CORESYMBOLS

%   Refinement
%%Zinchar \circrefines U+2291

%   Input field prefix colon
%%Zinchar \prefixcolon U+2236

%   Spivey's like definition symbol (or just \defs?)
%%Zinchar \circdef U+2259

%   Process indexing
%%Zinchar \circindex U+2299

%   Recursion
%%Zprechar \circmu U+00B5

%   Guarded command then
%%Zinchar \circthen U+27FC

%   Guarded command else
%%Zinchar \circelse U+25AF

%   Prefixing 
%%Zinchar \then U+27F6

%   Prefixing guards
%%Zinchar \circguard U+0026

%   Sequential composition
%%Zinchar \circseq U+037E

%   Replicated sequential composition
%%Zprechar \Semi U+2A1F

%   Process interleave
%%Zinchar \interleave U+2980

%   Replicated parallelism
%%Zprechar \Parallel U+2225

%   Replicated interleaving
%%Zprechar \Interleave U+2AFC

%   Hiding  
%   It must be a different Unicode from \setminus and \hide.
%   Otherwise, the KeywordScanner will raise a warning.
%%Zinchar \circhide U+2AF5

%   External choice
%%Zinchar \extchoice U+25FB

%   Replicated external choice
%%Zprechar \Extchoice U+25A1

%   Internal choice
%%Zinchar \intchoice U+2293

%   Replicated internal choice 
%%Zprechar \Intchoice U+2294

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% BRACKETS

%   Left/Right channel set brackets
%%Zchar \lchanset U+2983
%%Zchar \rchanset U+2984

%   Left/Right index instantiation brackets
%%Zchar \circlinst U+230A
%%Zchar \circrinst U+230B

%   Left/Right guarded action brackets
%%Zchar \lcircguard U+3014
%%Zchar \rcircguard U+3015

%   Left/Right schema expression action brackets
%%Zchar \lschexpract U+2768
%%Zchar \rschexpract U+2769

%   Left/Right process renaming square brackets
%%Zchar \lcircrename U+3016
%%Zchar \rcircrename U+3017

%   Left/Right interface parallel action/process brackets
%%Zinchar \lpar U+27E6
%%Zinchar \rpar U+27E7

%   Left/Right interleave action/process brackets
%%Zinchar \linter U+301A
%%Zinchar \rinter U+301B

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Alternatives          Observation
%
% \circindex    U+2A00  (2A00=bigger version). Use circus.sty \circindex instead of LaTeX \odot.
% \circlinst    U+23A3
% \circrinst    U+23A6, U+300D
% \Parallel     U+2016
% \Interleave   U+2980  Small version of |||
% \circdef      U+225D  = with def on the top of it.
% \Semi         U+2A3E
% \lcircguard   U+2772, U+2329, U+276C
% \rcircguard   U+2773, U+232A, U+276D


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Language keywords:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Guarded commands 

%   Circus alternative
%%Zpreword \circif if
%%Zpostword \circfi fi

%   Circus iteration
%%Zpreword \circdo do
%%Zpostword \circod od

%   Logical constants
%%Zpreword \circcon con

%   Variable declaration
%%Zpreword \circvar var

%   Parameter qualifiers: value, result, value-result
%%Zpreword \circval val
%%Zpreword \circres res
%%Zpreword \circvres vres


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Channel and name set

%   Channel declaration
%%Zpreword \circchannel channel

%   Channel declaration from schema inclusion
%%Zpreword \circchannelfrom channelfrom

%   Channel set declaration
%%Zpreword \circchannelset channelset

%   Name set declaration
%%Zpreword \circnameset nameset


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Processes

%   Process declaration
%%Zpreword \circprocess process

%   Basic process begin
%%Zpreword \circbegin begin

%   Basic process state
%%Zinword  \circstate state

%   Basic process end
%%Zpostword \circend end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Actions

%   Basic termination action
%%Zword \Skip Skip

%   Basic deadlock action
%%Zword \Stop Stop

%   Basic divergent (chaotic) action
%%Zword \Chaos Chaos


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Auxiliary definitions for the semantics of Circus
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% UTP related

%   UTP boolean value.
%   LaTeX equivalent to \mathcal{B}
%%Zchar \boolean U-0001D539
\begin{zed}
   \boolean ::= t | f
\end{zed}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Automata normalisation

%   Distributed disjointness between set of sets.
%   TODO: Find the equivalent in LaTeX for this Unicode.
%%Zinchar \gendj U+2A46
\begin{zed}
\function 40 \leftassoc (\_~\gendj~\_)
\end{zed}

\begin{gendef}[X]
    \_ \gendj \_: \power~(\power~X) \cross \power~(\power~X) \fun \power~X
\where
    \forall S, P: \power~(\power X) @ P \gendj S = (\bigcap~P)~\setminus~(\bigcup~(S~\setminus~P))
\end{gendef}

%   Non-empty regions of a non-empty set of sets. 
%   That is, the corresponding set of sets with nondeterminism clearly separated.
%   It is used in the normalisation algorithm for Circus automata.
%   LaTeX char equivalent to \otimes
%%Zprechar \regions U+2A02
\begin{gendef}[X]
    \regions: \power_1~(\power~X) \fun \power_1~(\power~X)
\where
    \forall S: \power_1~(\power~X) @ \\
      \t1 \regions S = \{~ P: \power_1~(\power~X) | P \subseteq S @ P \gendj S \}~\setminus~\{~ \emptyset ~\}
\end{gendef}

%   Calculates the minimal set of a set of sets.
%   That is, the sets that are minimal under subset inclusion.
%   It is used in the normalisation algorithm for Circus automata
%   while calculating minimal sets of coalesced (power) states.
\begin{gendef}[X]
    minimal: \power~(\power~X) \fun \power~(\power~X)
\where
   \forall SS: \power~(\power~X) @ \\
    \t1 minimal~SS = \{ S: \power~X | S \in SS \land \\
                \t2 \lnot~(~\exists R: \power~X | R \in SS @ R \subset S~) \}
\end{gendef}

%   Set difference distributed over set of sets.
%   It is used for in the operational semantics of parallelism. 
%   LaTeX char equivalent to \searrow.
%   The associativity is the same as \setminus.
%   The binding power of this operator template is slightly tigher than \setminus (30).
%%Zinchar \dsetminus U+21F2
\begin{zed}
    \function 35 \leftassoc (\_ \dsetminus \_)
\end{zed}

\begin{gendef}[X]
    \_ \dsetminus \_ : \power~(\power~X) \cross \power X \fun \power~(\power~X)           
\where
    \forall P: \power~(\power~X); p: \power~X @ P \dsetminus p = \{~ q: \power~X | q \in P @ q \setminus p ~\}
\end{gendef}

%   Set intersection distributed over set of sets.
%   It is used for in the operational semantics of parallelism.
%   LaTeX char equivalent to \lozenge(?).
%   Alternative unicode to use U+22C4, which has LaTeX equivalent as \diamond.
%   The associativity is the same as \cap.
%   The binding power of this operator template is slightly tigher than \cap (40).
%   We haven't used 45 because it has already been taken by a \rightassoc operator
%   in sequence_toolkit.tex (\_ \extract \_).
%%Zinchar \dcap U+25C7
\begin{zed}
    \function 44 \leftassoc (\_ \dcap \_)
\end{zed}

\begin{gendef}[X]
    \_ \dcap \_ : \power~(\power~X) \cross \power X \fun \power~(\power~X)
\where
    \forall~ P: \power~(\power~X); p: \power~X @ P \dcap p = \{~ q: \power~X | q \in P @ q \cap p ~\}
\end{gendef}
